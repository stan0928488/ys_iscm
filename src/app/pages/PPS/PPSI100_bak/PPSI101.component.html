<nz-content style="margin:0 16px;">
  <nz-breadcrumb style="margin:16px 0;">
    <nz-breadcrumb-item>基本資料表</nz-breadcrumb-item>
    <nz-breadcrumb-item>靜態表維護</nz-breadcrumb-item>
  </nz-breadcrumb>
  
  <nz-tabset [nzTabPosition]="'left'" [nzType]="'card'">
    <!-- 1.鋼種分類(鈞) -->
    <nz-tab nzTitle="鋼種分類" (nzClick)="changeTab(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">
        <table>
          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openGradeInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>
        </table>
      <p></p><p></p>
        <div nz-col [nzSpan]="10">
          <nz-table #RowTable1 nzBordered [nzData]="displayPPSINP01List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
              <tr>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
                >鋼種
                <nz-filter-trigger 
                [nzActive]="searchByGradeNoValue.length > 0" 
                [nzDropdownMenu]="gradeNoMenu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >特殊機台使用
                <nz-filter-trigger 
                [nzActive]="searchBySpecialEquipCodeValue.length > 0" 
                [nzDropdownMenu]="specialEquipCodeMenu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >鋼種類別
                <nz-filter-trigger 
                [nzActive]="searchByGradeGroupValue.length > 0" 
                [nzDropdownMenu]="gradeGroupMenu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of RowTable1.data;let i = index" class="editable-row">
                <ng-container *ngIf="!editCache1[data.id].edit; else editTemplate1">
                  <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.GRADE_NO }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.SPECIAL_EQUIP_CODE }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.GRADE_GROUP }}</td>
                  <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                    <a (click)="editRow(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow(data.id, 1)">刪除</a>
                  </td>
                </ng-container>
                <ng-template #editTemplate1>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入鋼種" [(ngModel)]="editCache1[data.id].data.GRADE_NO" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入特殊機台使用" [(ngModel)]="editCache1[data.id].data.SPECIAL_EQUIP_CODE" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="鋼種類別" [(ngModel)]="editCache1[data.id].data.GRADE_GROUP" />
                  </td>
                  <td>
                    <a (click)="saveEdit(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit(data.id, 1)">取消</a>
                  </td>
                </ng-template>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nz-tab>
    <!-- 2. 站別機台關聯表(雄)-->
    <nz-tab nzTitle="站別機台關聯表" (nzClick)="changeTab(2)">
    <div style="background: rgb(255, 255, 255); min-height: 1200px;">
      <table>
        <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openShopInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>
      </table>
      <p></p><p></p>
      <div nz-col [nzSpan]="30">
        <nz-table #RowTable7 nzBordered [nzData]="displayPPSINP07List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
          <thead>
          <tr>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
            >工廠別
            <nz-filter-trigger 
            [nzActive]="searchPlantValue.length > 0" 
            [nzDropdownMenu]="plantMenu">
            <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
            </th>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
            >站別代碼
            <nz-filter-trigger 
            [nzActive]="searchShopCodeValue.length > 0" 
            [nzDropdownMenu]="shopCodeMenu">
            <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
            </th>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
            >站別
            <nz-filter-trigger 
            [nzActive]="searchShopNameValue.length > 0" 
            [nzDropdownMenu]="shopNameMenu">
            <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
            </th>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px"
            >機台
            <nz-filter-trigger 
            [nzActive]="searchEquipCode1Value.length > 0" 
            [nzDropdownMenu]="equipCode1Menu">
            <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
            </th>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px"
            >設備名
            <nz-filter-trigger 
            [nzActive]="searchEquipNameValue.length > 0" 
            [nzDropdownMenu]="equipNameMenu">
            <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
            </th>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px"
            >機台群組
            <nz-filter-trigger 
            [nzActive]="searchEquipGroupValue.length > 0" 
            [nzDropdownMenu]="equipGroupMenu">
            <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
            </th>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px"
            >有效碼
            <nz-filter-trigger 
            [nzActive]="searchValidValue.length > 0" 
            [nzDropdownMenu]="validMenu">
            <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
            </th>
            <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let data of RowTable7.data;let i = index" class="editable-row">
            <ng-container *ngIf="!editCache7[data.id].edit; else editTemplate7">
              <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.PLANT }}</td>
              <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.SHOP_CODE }}</td>
              <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SHOP_NAME }}</td>
              <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.EQUIP_CODE_1 }}</td>
              <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.EQUIP_NAME }}</td>
              <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.EQUIP_GROUP }}</td>
              <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.VALID }}</td>
              <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                <a (click)="editRow(data.id, 2)">修改</a>&nbsp;
                <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow(data.id, 2)">刪除</a>
              </td>
            </ng-container>
            <ng-template #editTemplate7>
              <td>
                <input nz-width="20%" nz-input placeholder="輸入工廠別" [(ngModel)]="editCache7[data.id].data.PLANT" />
              </td>
              <td>
                <input nz-width="20%" nz-input placeholder="輸入站別代碼" [(ngModel)]="editCache7[data.id].data.SHOP_CODE" />
              </td>
              <td>
                <input nz-width="20%" nz-input placeholder="輸入站別" [(ngModel)]="editCache7[data.id].data.SHOP_NAME" />
              </td>
              <td>
                <input nz-width="20%" nz-input placeholder="輸入機台" [(ngModel)]="editCache7[data.id].data.EQUIP_CODE_1" />
              </td>
              <td>
                <input nz-width="20%" nz-input placeholder="輸入設備名" [(ngModel)]="editCache7[data.id].data.EQUIP_NAME" />
              </td>
              <td>
                <input nz-width="20%" nz-input placeholder="機台群組" [(ngModel)]="editCache7[data.id].data.EQUIP_GROUP" />
              </td>
              <td>
                <input nz-width="20%" nz-input placeholder="有效碼" [(ngModel)]="editCache7[data.id].data.VALID" />
              </td>
              <td>
                <a (click)="saveEdit(data.id, 2)">確認</a>&nbsp;&nbsp;&nbsp;
                <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit(data.id, 2)">取消</a>
              </td>
            </ng-template>
          </tr>
          </tbody>
        </nz-table>
      </div>
    </div>
  </nz-tab>
    <!-- 3.設備能力(鴻) -->
    <nz-tab nzTitle="設備能力" (nzClick)="changeTab2(1)">
      <div  style="background: rgb(255, 255, 255); width:auto; min-height: 1200px;">
        <table>
          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openCapabilityInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>
        </table>
      <p></p><p></p>

        <div nz-col [nzSpan]="25">
          <nz-table #RowTable2 nzBordered [nzData]="displayPPSINP02List" [nzPageSize]="20" [nzScroll]="{ x: '1800px', y: '500px' }">
            <thead>
              <tr>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
                >站號
                <nz-filter-trigger 
                [nzActive]="searchShopCode2Value.length > 0" 
                [nzDropdownMenu]="shopCode2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >機台群組
                <nz-filter-trigger 
                [nzActive]="searchEquipGroup2Value.length > 0" 
                [nzDropdownMenu]="equipGroup2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >機台
                <nz-filter-trigger 
                [nzActive]="searchEquipCode2Value.length > 0" 
                [nzDropdownMenu]="equipCode2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >製程碼
                <nz-filter-trigger 
                [nzActive]="searchProcessCode2Value.length > 0" 
                [nzDropdownMenu]="processCode2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >鋼種類別
                <nz-filter-trigger 
                [nzActive]="searchGradeGroup2Value.length > 0" 
                [nzDropdownMenu]="gradeGroup2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >形狀
                <nz-filter-trigger 
                [nzActive]="searchShapeType2Value.length > 0" 
                [nzDropdownMenu]="shapeType2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >投入尺寸上限
                <nz-filter-trigger 
                [nzActive]="searchInputDiaMax2Value.length > 0" 
                [nzDropdownMenu]="InputDiaMax2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >設備能力最小尺寸
                <nz-filter-trigger 
                [nzActive]="searchCapabilityDiaMin2Value.length > 0" 
                [nzDropdownMenu]="capabilityDiaMin2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >設備能力最大尺寸
                <nz-filter-trigger 
                [nzActive]="searchCapabilityDiaMax2Value.length > 0" 
                [nzDropdownMenu]="capabilityDiaMax2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >設備能力最小長度
                <nz-filter-trigger 
                [nzActive]="searchCapabilityLengthMin2Value.length > 0" 
                [nzDropdownMenu]="capabilityLengthMin2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >設備能力最大長度
                <nz-filter-trigger 
                [nzActive]="searchCapabilityLengthMax2Value.length > 0" 
                [nzDropdownMenu]="capabilityLengthMax2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >最佳能力最小尺寸
                <nz-filter-trigger 
                [nzActive]="searchOptimalDiaMin2Value.length > 0" 
                [nzDropdownMenu]="optimalDiaMin2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >最佳能力最大尺寸
                <nz-filter-trigger 
                [nzActive]="searchOptimalDiaMax2Value.length > 0" 
                [nzDropdownMenu]="optimalDiaMax2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >最佳能力最小長度
                <nz-filter-trigger 
                [nzActive]="searchOptimalLengthMin2Value.length > 0" 
                [nzDropdownMenu]="optimalLengthMin2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >最佳能力最大長度
                <nz-filter-trigger 
                [nzActive]="searchOptimalLengthMax2Value.length > 0" 
                [nzDropdownMenu]="optimalLengthMax2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >替代機台順位1
                <nz-filter-trigger 
                [nzActive]="searchoptionEquip1_2Value.length > 0" 
                [nzDropdownMenu]="optionEquip1_2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >替代機台順位2
                <nz-filter-trigger 
                [nzActive]="searchoptionEquip2_2Value.length > 0" 
                [nzDropdownMenu]="optionEquip2_2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >替代機台順位3
                <nz-filter-trigger 
                [nzActive]="searchoptionEquip3_2Value.length > 0" 
                [nzDropdownMenu]="optionEquip3_2Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of RowTable2.data;let i = index" class="editable-row">
                <ng-container *ngIf="!editCache2[data.id].edit; else editTemplate1">
                  <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.SHOP_CODE_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.EQUIP_GROUP_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.EQUIP_CODE_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.PROCESS_CODE_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.GRADE_GROUP_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SHAPE_TYPE_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.INPUT_DIA_MAX_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.CAPABILITY_DIA_MIN_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.CAPABILITY_DIA_MAX_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.CAPABILITY_LENGTH_MIN_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.CAPABILITY_LENGTH_MAX_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OPTIMAL_DIA_MIN_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OPTIMAL_DIA_MAX_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OPTIMAL_LENGTH_MIN_2 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OPTIMAL_LENGTH_MAX_2 | number}}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OPTION_EQUIP_1_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OPTION_EQUIP_2_2 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OPTION_EQUIP_3_2 }}</td>
                  <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                    <a (click)="editRow2(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow2(data.id, 1)">刪除</a>
                  </td>
                </ng-container>
                <ng-template #editTemplate1>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入站號" [(ngModel)]="editCache2[data.id].data.SHOP_CODE_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入機台群組" [(ngModel)]="editCache2[data.id].data.EQUIP_GROUP_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入機台" [(ngModel)]="editCache2[data.id].data.EQUIP_CODE_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入製程碼" [(ngModel)]="editCache2[data.id].data.PROCESS_CODE_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入鋼種類別" [(ngModel)]="editCache2[data.id].data.GRADE_GROUP_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入形狀" [(ngModel)]="editCache2[data.id].data.SHAPE_TYPE_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入投入尺寸上限" [(ngModel)]="editCache2[data.id].data.INPUT_DIA_MAX_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入設備能力最小尺寸" [(ngModel)]="editCache2[data.id].data.CAPABILITY_DIA_MIN_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入設備能力最大尺寸" [(ngModel)]="editCache2[data.id].data.CAPABILITY_DIA_MAX_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入設備能力最小長度" [(ngModel)]="editCache2[data.id].data.CAPABILITY_LENGTH_MIN_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入設備能力最大長度" [(ngModel)]="editCache2[data.id].data.CAPABILITY_LENGTH_MAX_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入最佳能力最小尺寸" [(ngModel)]="editCache2[data.id].data.OPTIMAL_DIA_MIN_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入最佳能力最大尺寸" [(ngModel)]="editCache2[data.id].data.OPTIMAL_DIA_MAX_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入最佳能力最小長度" [(ngModel)]="editCache2[data.id].data.OPTIMAL_LENGTH_MIN_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入最佳能力最大長度" [(ngModel)]="editCache2[data.id].data.OPTIMAL_LENGTH_MAX_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入替代機台順位1" [(ngModel)]="editCache2[data.id].data.OPTION_EQUIP_1_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入替代機台順位2" [(ngModel)]="editCache2[data.id].data.OPTION_EQUIP_2_2" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入替代機台順位3" [(ngModel)]="editCache2[data.id].data.OPTION_EQUIP_3_2" />
                  </td>
                  <td>
                    <a (click)="saveEdit2(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit2(data.id, 1)">取消</a>
                  </td>
                </ng-template>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>
    <!-- 4.整備 -->
    <nz-tab nzTitle="整備時間" (nzClick)="changeTab3(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">

        <table>
          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openPrepareInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>
        </table>
        <p></p><p></p>

        <div nz-col [nzSpan]="25">
          <nz-table #RowTable3 nzBordered [nzData]="displayPPSINP03List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
            <tr>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
              >機台
              <nz-filter-trigger 
              [nzActive]="searchEquipCodeValue.length > 0" 
              [nzDropdownMenu]="equipCodeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
              >上下料
              <nz-filter-trigger 
              [nzActive]="searchLoadTimeValue.length > 0" 
              [nzDropdownMenu]="loadTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >搬運
              <nz-filter-trigger 
              [nzActive]="searchTransferTimeValue.length > 0" 
              [nzDropdownMenu]="transferTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >其他整備
              <nz-filter-trigger 
              [nzActive]="searchOtherTimeValue.length > 0" 
              [nzDropdownMenu]="otherTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >大調機
              <nz-filter-trigger 
              [nzActive]="searchBigAdjustTimeValue.length > 0" 
              [nzDropdownMenu]="bigAdjustTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >小調機
              <nz-filter-trigger 
              [nzActive]="searchSmallAdjustTimeValue.length > 0" 
              [nzDropdownMenu]="smallAdjustTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >退料
              <nz-filter-trigger 
              [nzActive]="searchReturnTimeValue.length > 0" 
              [nzDropdownMenu]="returnTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >冷卻
              <nz-filter-trigger 
              [nzActive]="searchCoolingTimeValue.length > 0" 
              [nzDropdownMenu]="coolingTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let data of RowTable3.data;let i = index" class="editable-row">
              <ng-container *ngIf="!editCache3[data.id].edit; else editTemplate1">
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.EQUIP_CODE }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.LOAD_TIME | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.TRANSFER_TIME }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OTHER_TIME | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.BIG_ADJUST_TIME | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SMALL_ADJUST_TIME | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.RETURN_TIME | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.COOLING_TIME | number }}</td>
                <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                  <a (click)="editRow3(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow3(data.id, 1)">刪除</a>
                </td>
              </ng-container>
              <ng-template #editTemplate1>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入機台" [(ngModel)]="editCache3[data.id].data.EQUIP_CODE" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="上下料時間" [(ngModel)]="editCache3[data.id].data.LOAD_TIME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="搬運時間" [(ngModel)]="editCache3[data.id].data.TRANSFER_TIME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="其他整備時間" [(ngModel)]="editCache3[data.id].data.OTHER_TIME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="大調機時間" [(ngModel)]="editCache3[data.id].data.BIG_ADJUST_TIME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="小調機時間" [(ngModel)]="editCache3[data.id].data.SMALL_ADJUST_TIME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="退料時間" [(ngModel)]="editCache3[data.id].data.RETURN_TIME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="冷卻時間" [(ngModel)]="editCache3[data.id].data.COOLING_TIME" />
                </td>
                <td>
                  <a (click)="saveEdit3(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit3(data.id, 1)">取消</a>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>
    <!-- 5.大調機 -->
    <nz-tab nzTitle="大調機" (nzClick)="changeTab4(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">

        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openBigAdjustInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
      <p></p><p></p>

        <div nz-col [nzSpan]="10">
          <nz-table #RowTable4 nzBordered [nzData]="displayPPSINP04List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
              <tr>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
                >機台
                <nz-filter-trigger 
                [nzActive]="searchEquipCode4Value.length > 0" 
                [nzDropdownMenu]="equipCode4Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >產出尺寸最小值
                <nz-filter-trigger 
                [nzActive]="searchDiaMin4Value.length > 0" 
                [nzDropdownMenu]="diaMin4Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >產出尺寸最大值
                <nz-filter-trigger 
                [nzActive]="searchDiaMax4Value.length > 0" 
                [nzDropdownMenu]="diaMax4Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >產出型態
                <nz-filter-trigger 
                [nzActive]="searchShapeType4Value.length > 0" 
                [nzDropdownMenu]="shapeType4Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >大調機代碼
                <nz-filter-trigger 
                [nzActive]="searchBigAdjustCode4Value.length > 0" 
                [nzDropdownMenu]="bigAdjustCode4Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >小調機公差標準
                <nz-filter-trigger 
                [nzActive]="searchSmallAdjustTolerance4Value.length > 0" 
                [nzDropdownMenu]="smallAdjustTolerance4Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >爐批數量
                <nz-filter-trigger 
                [nzActive]="searchFuranceBatchQty4Value.length > 0" 
                [nzDropdownMenu]="furanceBatchQty4Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of RowTable4.data;let i = index" class="editable-row">
                <ng-container *ngIf="!editCache4[data.id].edit; else editTemplate1">
                  <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.EQUIP_CODE_4 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.DIA_MIN_4 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MAX_4 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SHAPE_TYPE_4 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.BIG_ADJUST_CODE_4 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SMALL_ADJUST_TOLERANCE_4 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.FURANCE_BATCH_QTY_4 | number }}</td>
                  <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                    <a (click)="editRow4(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow4(data.id, 1)">刪除</a>
                  </td>
                </ng-container>
                <ng-template #editTemplate1>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入機台" [(ngModel)]="editCache4[data.id].data.EQUIP_CODE_4" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入尺寸最小值" [(ngModel)]="editCache4[data.id].data.DIA_MIN_4" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入尺寸最大值" [(ngModel)]="editCache4[data.id].data.DIA_MAX_4" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入產出型態" [(ngModel)]="editCache4[data.id].data.SHAPE_TYPE_4" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入大調機代碼" [(ngModel)]="editCache4[data.id].data.BIG_ADJUST_CODE_4" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入小調機公差標準" [(ngModel)]="editCache4[data.id].data.SMALL_ADJUST_TOLERANCE_4" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="輸入爐批數量" [(ngModel)]="editCache4[data.id].data.FURANCE_BATCH_QTY_4" />
                  </td>
                  <td>
                    <a (click)="saveEdit4(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit4(data.id, 1)">取消</a>
                  </td>
                </ng-template>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>
    <!-- 6.小調機 -->
    <nz-tab nzTitle="小調機" (nzClick)="changeTab17(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">
        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openSmallAdjustInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
        <p></p><p></p>

        <div nz-col [nzSpan]="25">
          <nz-table class="table17" #RowTable17 nzBordered [nzData]="displayPPSINP17List" [nzPageSize]="20" [nzScroll]="{y: '500px'}">
            <thead>
            <tr>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
              >機台
              <nz-filter-trigger 
              [nzActive]="searchEquipCode17Value.length > 0" 
              [nzDropdownMenu]="equipCode17Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
              >產出尺寸最小值
              <nz-filter-trigger 
              [nzActive]="searchDiaMin17Value.length > 0" 
              [nzDropdownMenu]="diaMin17Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出尺寸最大值
              <nz-filter-trigger 
              [nzActive]="searchDiaMax17Value.length > 0" 
              [nzDropdownMenu]="diaMax17Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出型態
              <nz-filter-trigger 
              [nzActive]="searchShapeType17Value.length > 0" 
              [nzDropdownMenu]="shapeType17Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >小調機代碼
              <nz-filter-trigger 
              [nzActive]="searchSmallAdjustCode17Value.length > 0" 
              [nzDropdownMenu]="smallAdjustCode17Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >小調機公差標準
              <nz-filter-trigger 
              [nzActive]="searchSmallAdjustTolerance17Value.length > 0" 
              [nzDropdownMenu]="smallAdjustTolerance17Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >爐批數量
              <nz-filter-trigger 
              [nzActive]="searchFuranceBatchQty17Value.length > 0" 
              [nzDropdownMenu]="furanceBatchQty17Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:200px">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let data of RowTable17.data;let i = index" class="editable-row">
              <ng-container *ngIf="!editCache17[data.id].edit; else editTemplate1">
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.EQUIP_CODE_17 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.DIA_MIN_17 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MAX_17 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SHAPE_TYPE_17 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SMALL_ADJUST_CODE_17 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SMALL_ADJUST_TOLERANCE_17 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.FURANCE_BATCH_QTY_17 | number }}</td>
                <td style="text-align:center; padding: 0px; height: 60px; width: 200px;">
                  <a (click)="editRow17(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow17(data.id, 1)">刪除</a>
                </td>
              </ng-container>
              <ng-template #editTemplate1>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入機台" [(ngModel)]="editCache17[data.id].data.EQUIP_CODE_17" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入尺寸最小值" [(ngModel)]="editCache17[data.id].data.DIA_MIN_17" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入尺寸最大值" [(ngModel)]="editCache17[data.id].data.DIA_MAX_17" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入產出型態" [(ngModel)]="editCache17[data.id].data.SHAPE_TYPE_17" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入大調機代碼" [(ngModel)]="editCache17[data.id].data.SMALL_ADJUST_CODE_17" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入小調機公差標準" [(ngModel)]="editCache17[data.id].data.SMALL_ADJUST_TOLERANCE_17" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入爐批數量" [(ngModel)]="editCache17[data.id].data.FURANCE_BATCH_QTY_17" />
                </td>
                <td>
                  <a (click)="saveEdit17(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit17(data.id, 1)">取消</a>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>
    <!-- 7.線速 -->
    <nz-tab nzTitle="線速" (nzClick)="changeTab05(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">
        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openSpeedInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
        <p></p><p></p>

        <div nz-col [nzSpan]="25">
          <nz-table class="table05" #RowTable05 nzBordered [nzData]="displayPPSINP05List" [nzPageSize]="20" [nzScroll]="{y: '500px'}">
            <thead>
            <tr>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
              >站號
              <nz-filter-trigger 
              [nzActive]="searchShopCode5Value.length > 0" 
              [nzDropdownMenu]="shopCode5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
              >機台
              <nz-filter-trigger 
              [nzActive]="searchEquipCode5Value.length > 0" 
              [nzDropdownMenu]="equipCode5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出型態
              <nz-filter-trigger 
              [nzActive]="searchShapeType5Value.length > 0" 
              [nzDropdownMenu]="shapeType5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >鋼種類別
              <nz-filter-trigger 
              [nzActive]="searchGradeGroup5Value.length > 0" 
              [nzDropdownMenu]="gradeGroup5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >線速分類
              <nz-filter-trigger 
              [nzActive]="searchSpeedType5Value.length > 0" 
              [nzDropdownMenu]="speedType5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >減面率MIN
              <nz-filter-trigger 
              [nzActive]="searchReductionRateMin5Value.length > 0" 
              [nzDropdownMenu]="reductionRateMin5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >減面率MAX
              <nz-filter-trigger 
              [nzActive]="searchReductionRateMax5Value.length > 0" 
              [nzDropdownMenu]="reductionRateMax5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
              >產出尺寸最小值
              <nz-filter-trigger 
              [nzActive]="searchDiaMax5Value.length > 0" 
              [nzDropdownMenu]="diaMax5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出尺寸最大值
              <nz-filter-trigger 
              [nzActive]="searchDiaMin5Value.length > 0" 
              [nzDropdownMenu]="diaMin5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:200px"
              >線速(公尺/分)
              <nz-filter-trigger 
              [nzActive]="searchSpeed5Value.length > 0" 
              [nzDropdownMenu]="speed5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:200px"
              >日產出量
              <nz-filter-trigger 
              [nzActive]="searchEquipCap5Value.length > 0" 
              [nzDropdownMenu]="equipCap5Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:200px">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let data of RowTable05.data;let i = index" class="editable-row">
              <ng-container *ngIf="!editCache05[data.id].edit; else editTemplate1">
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.SHOP_CODE_5 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.EQUIP_CODE_5 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SHAPE_TYPE_5 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.GRADE_GROUP_5 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SPEED_TYPE_5 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.REDUCTION_RATE_MIN_5 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.REDUCTION_RATE_MAX_5 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MAX_5 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MIN_5 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SPEED_5 | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.EQUIP_CAP_5 | number }}</td>
                <td style="text-align:center; padding: 0px; height: 60px; width: 200px;">
                  <a (click)="editRow05(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow05(data.id, 1)">刪除</a>
                </td>
              </ng-container>
              <ng-template #editTemplate1>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入站別" [(ngModel)]="editCache05[data.id].data.SHOP_CODE_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入機台" [(ngModel)]="editCache05[data.id].data.EQUIP_CODE_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入產出型態" [(ngModel)]="editCache05[data.id].data.SHAPE_TYPE_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入鋼種分類" [(ngModel)]="editCache05[data.id].data.GRADE_GROUP_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入線速分類" [(ngModel)]="editCache05[data.id].data.SPEED_TYPE_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入減面率MIN" [(ngModel)]="editCache05[data.id].data.REDUCTION_RATE_MIN_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入減面率MAX" [(ngModel)]="editCache05[data.id].data.REDUCTION_RATE_MAX_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入尺寸最小值" [(ngModel)]="editCache05[data.id].data.DIA_MIN_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入尺寸最大值" [(ngModel)]="editCache05[data.id].data.DIA_MAX_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入線速" [(ngModel)]="editCache05[data.id].data.SPEED_5" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入日產出量" [(ngModel)]="editCache05[data.id].data.EQUIP_CAP_5" />
                </td>
                <td>
                  <a (click)="saveEdit05(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit05(data.id, 1)">取消</a>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>
    <!-- 8.非線速 -->
    <nz-tab nzTitle="非線速" (nzClick)="changeTab8(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">

        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openNonSpeedInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
      <p></p><p></p>

        <div nz-col [nzSpan]="90">
          <nz-table #RowTable8 nzBordered [nzData]="displayPPSINP08List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
              <tr>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
                >站號
                <nz-filter-trigger 
                [nzActive]="searchShopCode8Value.length > 0" 
                [nzDropdownMenu]="shopCode8Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >機台
                <nz-filter-trigger 
                [nzActive]="searchEquipCode8Value.length > 0" 
                [nzDropdownMenu]="equipCode8Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >產出形狀
                <nz-filter-trigger 
                [nzActive]="searchShapeType8Value.length > 0" 
                [nzDropdownMenu]="shapeType8Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >產出尺寸最小值
                <nz-filter-trigger 
                [nzActive]="searchDiaMin8Value.length > 0" 
                [nzDropdownMenu]="diaMin8Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >產出尺寸最大值
                <nz-filter-trigger 
                [nzActive]="searchDiaMax8Value.length > 0" 
                [nzDropdownMenu]="diaMax8Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >加工時間
                <nz-filter-trigger 
                [nzActive]="searchMins8Value.length > 0" 
                [nzDropdownMenu]="mins8Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of RowTable8.data;let i = index" class="editable-row">
                <ng-container *ngIf="!editCache8[data.id].edit; else editTemplate1">
                  <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.SHOP_CODE_8 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.EQUIP_CODE_8 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SHAPE_TYPE_8 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MIN_8 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MAX_8 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.MINS_8 }}</td>
                  <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                    <a (click)="editRow8(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow8(data.id, 1)">刪除</a>
                  </td>
                </ng-container>
                <ng-template #editTemplate1>
                  <td>
                    <input nz-width="20%" nz-input placeholder="站號" [(ngModel)]="editCache8[data.id].data.SHOP_CODE_8" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="機台" [(ngModel)]="editCache8[data.id].data.EQUIP_CODE_8" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="產出形狀" [(ngModel)]="editCache8[data.id].data.SHAPE_TYPE_8" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="產出尺寸最小值" [(ngModel)]="editCache8[data.id].data.DIA_MIN_8" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="產出尺寸最大值" [(ngModel)]="editCache8[data.id].data.DIA_MAX_8" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="加工時間" [(ngModel)]="editCache8[data.id].data.MINS_8" />
                  </td>
                  <td>
                    <a (click)="saveEdit8(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit8(data.id, 1)">取消</a>
                  </td>
                </ng-template>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>
    <!-- 9.退火爐工時 -->
    <nz-tab nzTitle="退火爐工時" (nzClick)="changeTab9(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">

        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openStoveInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
      <p></p><p></p>

        <div nz-col [nzSpan]="90">
          <nz-table #RowTable9 nzBordered [nzData]="displayPPSINP09List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
              <tr>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
                >站號
                <nz-filter-trigger 
                [nzActive]="searchShopCode9Value.length > 0" 
                [nzDropdownMenu]="shopCode9Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >機台
                <nz-filter-trigger 
                [nzActive]="searchEquipCode9Value.length > 0" 
                [nzDropdownMenu]="equipCode9Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >作業代碼
                <nz-filter-trigger 
                [nzActive]="searchOpCode9Value.length > 0" 
                [nzDropdownMenu]="opCode9Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >溫度
                <nz-filter-trigger 
                [nzActive]="searchTemperature9Value.length > 0" 
                [nzDropdownMenu]="temperature9Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >頻率
                <nz-filter-trigger 
                [nzActive]="searchFrequency9Value.length > 0" 
                [nzDropdownMenu]="frequency9Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >每噸花時間
                <nz-filter-trigger 
                [nzActive]="searchSteelGradeMin9Value.length > 0" 
                [nzDropdownMenu]="steelGradeMin9Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of RowTable9.data;let i = index" class="editable-row">
                <ng-container *ngIf="!editCache9[data.id].edit; else editTemplate1">
                  <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.SHOP_CODE_9 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.EQUIP_CODE_9 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OP_CODE_9 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.TEMPERATURE_9 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.FREQUENCY_9 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.STEEL_GRADE_MIN_9 }}</td>
                  <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                    <a (click)="editRow9(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow9(data.id, 1)">刪除</a>
                  </td>
                </ng-container>
                <ng-template #editTemplate1>
                  <td>
                    <input nz-width="20%" nz-input placeholder="站號" [(ngModel)]="editCache9[data.id].data.SHOP_CODE_9" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="機台" [(ngModel)]="editCache9[data.id].data.EQUIP_CODE_9" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="作業代碼" [(ngModel)]="editCache9[data.id].data.OP_CODE_9" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="溫度" [(ngModel)]="editCache9[data.id].data.TEMPERATURE_9" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="頻率" [(ngModel)]="editCache9[data.id].data.FREQUENCY_9" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="每噸花時間" [(ngModel)]="editCache9[data.id].data.STEEL_GRADE_MIN_9" />
                  </td>
                  <td>
                    <a (click)="saveEdit9(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit9(data.id, 1)">取消</a>
                  </td>
                </ng-template>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nz-tab>
    <!-- 10.其他站別工時 -->
    <nz-tab nzTitle="其他站別工時" (nzClick)="changeTab10(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">

        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openOtherShopInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
      <p></p><p></p>

        <div nz-col [nzSpan]="25">
          <nz-table #RowTable10 nzBordered [nzData]="displayPPSINP10List" [nzPageSize]="20" [nzScroll]="{ x: '1400px', y: '500px' }">
            <thead>
              <tr>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
                >站號
                <nz-filter-trigger 
                [nzActive]="searchShopCode10Value.length > 0" 
                [nzDropdownMenu]="shopCode10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
                >機台碼
                <nz-filter-trigger 
                [nzActive]="searchEquipCode10Value.length > 0" 
                [nzDropdownMenu]="equipCode10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >鋼種
                <nz-filter-trigger 
                [nzActive]="searchGradeNo10Value.length > 0" 
                [nzDropdownMenu]="gradeNo10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >長度-最小值(mm)
                <nz-filter-trigger 
                [nzActive]="searchLengthMin10Value.length > 0" 
                [nzDropdownMenu]="lengthMin10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >長度-最大值(mm)
                <nz-filter-trigger 
                [nzActive]="searchLengthMax10Value.length > 0" 
                [nzDropdownMenu]="lengthMax10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >尺寸最小
                <nz-filter-trigger 
                [nzActive]="searchDiaMin10Value.length > 0" 
                [nzDropdownMenu]="diaMin10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >尺寸最大
                <nz-filter-trigger 
                [nzActive]="searchDiaMax10Value.length > 0" 
                [nzDropdownMenu]="diaMax10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >總時間(分/批)
                <nz-filter-trigger 
                [nzActive]="searchTotalTimes10Value.length > 0" 
                [nzDropdownMenu]="totalTimes10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >浸酸時間(分/批)
                <nz-filter-trigger 
                [nzActive]="searchPicklingTimes10Value.length > 0" 
                [nzDropdownMenu]="picklingTimes10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >清洗時間(分/批)
                <nz-filter-trigger 
                [nzActive]="searchWashingTimes10Value.length > 0" 
                [nzDropdownMenu]="washingTimes10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >瀝乾時間(分/批)
                <nz-filter-trigger 
                [nzActive]="searchDrainingTimes10Value.length > 0" 
                [nzDropdownMenu]="drainingTimes10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
                >投入上限值(捆/批)
                <nz-filter-trigger 
                [nzActive]="searchBatchCnt10Value.length > 0" 
                [nzDropdownMenu]="batchCnt10Menu">
                <span nz-icon nzType="search"></span>
                </nz-filter-trigger>
                </th>
                <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of RowTable10.data;let i = index" class="editable-row">
                <ng-container *ngIf="!editCache10[data.id].edit; else editTemplate1">
                  <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.SHOP_CODE_10 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.EQUIP_CODE_10 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.GRADE_NO_10 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.LENGTH_MIN_10 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.LENGTH_MAX_10 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MIN_10 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MAX_10 | number }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.TOTAL_TIMES_10 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.PICKLING_TIMES_10 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.WASHING_TIMES_10 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DRAINING_TIMES_10 }}</td>
                  <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.BATCH_CNT_10 | number }}</td>
                  <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                    <a (click)="editRow10(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow10(data.id, 1)">刪除</a>
                  </td>
                </ng-container>
                <ng-template #editTemplate1>
                  <td>
                    <input nz-width="20%" nz-input placeholder="站號" [(ngModel)]="editCache10[data.id].data.SHOP_CODE_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="機台碼" [(ngModel)]="editCache10[data.id].data.EQUIP_CODE_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="鋼種" [(ngModel)]="editCache10[data.id].data.GRADE_NO_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="長度-最小值(mm)" [(ngModel)]="editCache10[data.id].data.LENGTH_MIN_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="長度-最大值(mm)" [(ngModel)]="editCache10[data.id].data.LENGTH_MAX_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="尺寸最小" [(ngModel)]="editCache10[data.id].data.DIA_MIN_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="尺寸最大" [(ngModel)]="editCache10[data.id].data.DIA_MAX_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="總時間(分/批)" [(ngModel)]="editCache10[data.id].data.TOTAL_TIMES_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="浸酸時間(分/批)" [(ngModel)]="editCache10[data.id].data.PICKLING_TIMES_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="清洗時間(分/批)" [(ngModel)]="editCache10[data.id].data.WASHING_TIMES_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="瀝乾時間(分/批)" [(ngModel)]="editCache10[data.id].data.DRAINING_TIMES_10" />
                  </td>
                  <td>
                    <input nz-width="20%" nz-input placeholder="投入上限值(捆/批)" [(ngModel)]="editCache10[data.id].data.BATCH_CNT_10" />
                  </td>
                  <td>
                    <a (click)="saveEdit10(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                    <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit10(data.id, 1)">取消</a>
                  </td>
                </ng-template>
              </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>
    <!-- 11.研磨道次(雄) -->
    <nz-tab nzTitle="研磨道次" (nzClick)="changeTab(13)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">
        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openGrindingInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
        <p></p><p></p>

        <div nz-col [nzSpan]="30">
          <nz-table #RowTable13 nzBordered [nzData]="displayPPSINP13List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
            <tr>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
              >鋼種類別
              <nz-filter-trigger 
              [nzActive]="searchGradeNo13Value.length > 0" 
              [nzDropdownMenu]="gradeNo13Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
              >產出型態
              <nz-filter-trigger 
              [nzActive]="searchOutTypeValue.length > 0" 
              [nzDropdownMenu]="outTypeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出成品尺寸最小值
              <nz-filter-trigger 
              [nzActive]="searchDiaMinValue.length > 0" 
              [nzDropdownMenu]="diaMinMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出成品尺寸最大值
              <nz-filter-trigger 
              [nzActive]="searchDiaMaxValue.length > 0" 
              [nzDropdownMenu]="diaMaxMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >研磨道次
              <nz-filter-trigger 
              [nzActive]="searchGrindingPassValue.length > 0" 
              [nzDropdownMenu]="grindingPassMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >每刀研磨尺寸
              <nz-filter-trigger 
              [nzActive]="searchGrindingSizeValue.length > 0" 
              [nzDropdownMenu]="grindingSizeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let data of RowTable13.data;let i = index" class="editable-row">
              <ng-container *ngIf="!editCache13[data.id].edit; else editTemplate13">
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.GRADE_NO_13 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.OUT_TYPE }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.DIA_MIN | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.DIA_MAX | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.GRINDING_PASS | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.GRINDING_SIZE | number }}</td>
                <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                  <a (click)="editRow(data.id, 13)">修改</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow(data.id, 13)">刪除</a>
                </td>
              </ng-container>
              <ng-template #editTemplate13>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入鋼種" [(ngModel)]="editCache13[data.id].data.GRADE_NO_13" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="產出型態" [(ngModel)]="editCache13[data.id].data.OUT_TYPE" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="產出成品尺寸最小值" [(ngModel)]="editCache13[data.id].data.DIA_MIN" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="產出成品尺寸最大值" [(ngModel)]="editCache13[data.id].data.DIA_MAX" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="研磨道次" [(ngModel)]="editCache13[data.id].data.GRINDING_PASS" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="每刀研磨尺寸" [(ngModel)]="editCache13[data.id].data.GRINDING_SIZE" />
                </td>
                <td>
                  <a (click)="saveEdit(data.id, 13)">確認</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit(data.id, 13)">取消</a>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nz-tab>
    <!-- 12.Campaign限制(雄) -->
    <nz-tab nzTitle="Campaign限制" (nzClick)="changeTab(16)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">
        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openCampaignInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>

        </table>
        <p></p><p></p>
        <div nz-col [nzSpan]="30">
          <nz-table #RowTable16 nzBordered [nzData]="displayPPSINP16List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
            <tr>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
              >站別
              <nz-filter-trigger 
              [nzActive]="searchShopCodeScheValue.length > 0" 
              [nzDropdownMenu]="shopCodeScheMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
              >機台
              <nz-filter-trigger 
              [nzActive]="searchChooseEquipCodeValue.length > 0" 
              [nzDropdownMenu]="chooseEquipCodeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >Campaign ID
              <nz-filter-trigger 
              [nzActive]="searchCompaignIdValue.length > 0" 
              [nzDropdownMenu]="compaignIdMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >欄位
              <nz-filter-trigger 
              [nzActive]="searchParameterColValue.length > 0" 
              [nzDropdownMenu]="parameterColMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >條件
              <nz-filter-trigger 
              [nzActive]="searchParameterConditionValue.length > 0" 
              [nzDropdownMenu]="parameterConditionMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >參數
              <nz-filter-trigger 
              [nzActive]="searchParameterNameValue.length > 0" 
              [nzDropdownMenu]="parameterNameMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出尺寸MIN
              <nz-filter-trigger 
              [nzActive]="searchTurnDiaMaxMinValue.length > 0" 
              [nzDropdownMenu]="turnDiaMaxMinMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出尺寸MAX
              <nz-filter-trigger 
              [nzActive]="searchTurnDiaMaxMaxValue.length > 0" 
              [nzDropdownMenu]="turnDiaMaxMaxMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >抽數別
              <nz-filter-trigger 
              [nzActive]="searchScheTypeValue.length > 0" 
              [nzDropdownMenu]="scheTypeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >交期區間MIN
              <nz-filter-trigger 
              [nzActive]="searchDataDeliveryRangeMinValue.length > 0" 
              [nzDropdownMenu]="dataDeliveryRangeMinMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >交期區間MAX
              <nz-filter-trigger 
              [nzActive]="searchDataDeliveryRangeMaxValue.length > 0" 
              [nzDropdownMenu]="dataDeliveryRangeMaxMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >生產日期 起
              <nz-filter-trigger 
              [nzActive]="searchStartTimeValue.length > 0" 
              [nzDropdownMenu]="startTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >生產日期 訖
              <nz-filter-trigger 
              [nzActive]="searchEndTimeValue.length > 0" 
              [nzDropdownMenu]="endTimeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let data of RowTable16.data;let i = index" class="editable-row">
              <ng-container *ngIf="!editCache16[data.id].edit; else editTemplate16">
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.SHOP_CODE_SCHE }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.CHOOSE_EQUIP_CODE }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.COMPAIGN_ID }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.PARAMETER_COL }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.PARAMETER_CONDITION }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.PARAMETER_NAME }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.TURN_DIA_MAX_MIN | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.TURN_DIA_MAX_MAX | number }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.SCHE_TYPE }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.DATA_DELIVERY_RANGE_MIN }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.DATA_DELIVERY_RANGE_MAX }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.START_TIME }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.END_TIME }}</td>
                <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                  <a (click)="editRow(data.id, 16)">修改</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow(data.id, 16)">刪除</a>
                </td>
              </ng-container>
              <ng-template #editTemplate16>
                <td>
                  <input nz-width="20%" nz-input placeholder="站別" [(ngModel)]="editCache16[data.id].data.SHOP_CODE_SCHE" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="機台" [(ngModel)]="editCache16[data.id].data.CHOOSE_EQUIP_CODE" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="Campaign ID" [(ngModel)]="editCache16[data.id].data.COMPAIGN_ID" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="欄位" [(ngModel)]="editCache16[data.id].data.PARAMETER_COL" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="條件" [(ngModel)]="editCache16[data.id].data.PARAMETER_CONDITION" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="參數" [(ngModel)]="editCache16[data.id].data.PARAMETER_NAME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="產出尺寸MIN" [(ngModel)]="editCache16[data.id].data.TURN_DIA_MAX_MIN" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="產出尺寸MAX" [(ngModel)]="editCache16[data.id].data.TURN_DIA_MAX_MAX" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="抽數別" [(ngModel)]="editCache16[data.id].data.SCHE_TYPE" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="交期區間MIN" [(ngModel)]="editCache16[data.id].data.DATA_DELIVERY_RANGE_MIN" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="交期區間MAX" [(ngModel)]="editCache16[data.id].data.DATA_DELIVERY_RANGE_MAX" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="生產日期 起" [(ngModel)]="editCache16[data.id].data.START_TIME" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="生產日期 訖" [(ngModel)]="editCache16[data.id].data.END_TIME" />
                </td>
                <td>
                  <a (click)="saveEdit(data.id, 16)">確認</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit(data.id, 16)">取消</a>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>
    </nz-tab>
    <!-- 13.清洗站設備能力表 -->
    <nz-tab nzTitle="清洗站設備能力表" (nzClick)="changeTab20(1)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">

        <table>

          <tr>
            <td>
              <button
              nz-button
              style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
              nzType="primary"
              [nzSize]="'large'"
              (click)="openWashInput()"
              ><span nz-icon nzType="plus" nzTheme="outline"></span>
                新增
              </button>
            </td>
          </tr>
          


          <!-- <tr>
            <td>機台</td>
            <td><input nz-input style="width:60%;" placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_20" />
            </td>
            <td>&nbsp;&nbsp;產品種類</td>
            <td><input nz-input style="width:60%;" placeholder="輸入產品種類" [(ngModel)]="KIND_TYPE_20" />
            </td>
            <td>&nbsp;&nbsp;產出型態</td>
            <td><input nz-input style="width:50%;" placeholder="輸入產出型態" [(ngModel)]="OUTPUT_SHAPE_20" />
            </td>
            <td>&nbsp;&nbsp;製程碼</td>
            <td><input nz-input style="width:50%;" placeholder="輸入製程碼" [(ngModel)]="PROCESS_CODE_20" />
            </td>
            <td>&nbsp;&nbsp;FINAL_製程</td>
            <td><input nz-input style="width:50%;" placeholder="輸入FINAL_製程" [(ngModel)]="FINAL_PROCESS_20" />
            </td>
            <td>&nbsp;&nbsp;抽數別</td>
            <td><input nz-input style="width:50%;" placeholder="輸入抽數別" [(ngModel)]="SCHE_TYPE_20" />
            </td>
            <td>
              &nbsp;&nbsp;
              <button
                      nz-button
                      style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
                      nzType="primary"
                      (click)="insertTab20()"
              >
                <span nz-icon nzType="save" nzTheme="outline"></span>
                確認
              </button>
            </td>
          </tr> -->
        </table>
        <p></p><p></p>

        <div nz-col [nzSpan]="25">
          <nz-table #RowTable20 nzBordered [nzData]="displayPPSINP20List" [nzPageSize]="20" [nzScroll]="{ y: '500px' }">
            <thead>
            <tr>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:100px"
              >機台
              <nz-filter-trigger 
              [nzActive]="searchEquipCode20Value.length > 0" 
              [nzDropdownMenu]="equipCode20Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:150px"
              >產品種類
              <nz-filter-trigger 
              [nzActive]="searchKindType20Value.length > 0" 
              [nzDropdownMenu]="kindType20Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >產出型態
              <nz-filter-trigger 
              [nzActive]="searchOutputShape20Value.length > 0" 
              [nzDropdownMenu]="outputShape20Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >製程碼
              <nz-filter-trigger 
              [nzActive]="searchProcessCode20Value.length > 0" 
              [nzDropdownMenu]="processCode20Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >FINAL_製程
              <nz-filter-trigger 
              [nzActive]="searchFinalProcess20Value.length > 0" 
              [nzDropdownMenu]="finalProcess20Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:120px"
              >抽數別
              <nz-filter-trigger 
              [nzActive]="searchScheType20Value.length > 0" 
              [nzDropdownMenu]="scheType20Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th style="text-align:center; background-color: #eee; padding: 0px; height: 55px; width:80px">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let data of RowTable20.data;let i = index" class="editable-row">
              <ng-container *ngIf="!editCache20[data.id].edit; else editTemplate1">
                <td style="text-align:center; padding: 5px; height: 60px; width: 100px;">{{ data.EQUIP_CODE_20 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 150px;">{{ data.KIND_TYPE_20 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.OUTPUT_SHAPE_20 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.PROCESS_CODE_20 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.FINAL_PROCESS_20 }}</td>
                <td style="text-align:center; padding: 5px; height: 60px; width: 120px;">{{ data.SCHE_TYPE_20 }}</td>
                <td style="text-align:center; padding: 0px; height: 60px; width: 120px;">
                  <a (click)="editRow20(data.id, 1)">修改</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteRow20(data.id, 1)">刪除</a>
                </td>
              </ng-container>
              <ng-template #editTemplate1>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入機台" [(ngModel)]="editCache20[data.id].data.EQUIP_CODE_20" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入產品種類" [(ngModel)]="editCache20[data.id].data.KIND_TYPE_20" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入產出型態" [(ngModel)]="editCache20[data.id].data.OUTPUT_SHAPE_20" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入製程碼" [(ngModel)]="editCache20[data.id].data.PROCESS_CODE_20" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入FINAL_製程" [(ngModel)]="editCache20[data.id].data.FINAL_PROCESS_20" />
                </td>
                <td>
                  <input nz-width="20%" nz-input placeholder="輸入抽數別" [(ngModel)]="editCache20[data.id].data.SCHE_TYPE_20" />
                </td>
                <td>
                  <a (click)="saveEdit20(data.id, 1)">確認</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit20(data.id, 1)">取消</a>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>

    <!-- 14.產率設定表 -->
    <nz-tab nzTitle="產率設定" (nzClick)="changeTab(14)">
      <div style="background: rgb(255, 255, 255); min-height: 1200px;">
<!-- 
        <table>
          <tr>
            <td>機台</td>
            <td><input nz-input style="width:60%;" placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_20" />
            </td>
            <td>&nbsp;&nbsp;產品種類</td>
            <td><input nz-input style="width:60%;" placeholder="輸入產品種類" [(ngModel)]="KIND_TYPE_20" />
            </td>
            <td>&nbsp;&nbsp;產出型態</td>
            <td><input nz-input style="width:50%;" placeholder="輸入產出型態" [(ngModel)]="OUTPUT_SHAPE_20" />
            </td>
            <td>&nbsp;&nbsp;製程碼</td>
            <td><input nz-input style="width:50%;" placeholder="輸入製程碼" [(ngModel)]="PROCESS_CODE_20" />
            </td>
            <td>&nbsp;&nbsp;FINAL_製程</td>
            <td><input nz-input style="width:50%;" placeholder="輸入FINAL_製程" [(ngModel)]="FINAL_PROCESS_20" />
            </td>
            <td>&nbsp;&nbsp;抽數別</td>
            <td><input nz-input style="width:50%;" placeholder="輸入抽數別" [(ngModel)]="SCHE_TYPE_20" />
            </td>
            <td>
              &nbsp;&nbsp;
              <button
                      nz-button
                      style="box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);"
                      nzType="primary"
                      (click)="insertTab20()"
              >
                <span nz-icon nzType="save" nzTheme="outline"></span>
                確認
              </button>
            </td>
          </tr>
        </table>
        <p></p><p></p> -->

        <div nz-col [nzSpan]="8">
          <nz-table #RowTable14 nzBordered [nzData]="displayTbppsm012List" [nzPageSize]="15" [nzScroll]="{ y: '650px' }">
            <thead>
            <tr>
              <th nzWidth="5%" style="text-align:center; background-color: #eee; padding: 0px; height: 55px;"
              >站別
              <nz-filter-trigger 
              [nzActive]="searchSchShopCodeValue.length > 0" 
              [nzDropdownMenu]="schShopCodeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th nzWidth="5%" style="text-align:center; background-color: #eee; padding: 0px; height: 55px;"
              >機群
              <nz-filter-trigger 
              [nzActive]="searchEquipGroup3Value.length > 0" 
              [nzDropdownMenu]="equipGroup3Menu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th nzWidth="5%" style="text-align:center; background-color: #eee; padding: 0px; height: 55px;"
              >設定類型
              <nz-filter-trigger 
              [nzActive]="searchYieldTypeValue.length > 0" 
              [nzDropdownMenu]="yieldTypeMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th nzWidth="5%" style="text-align:center; background-color: #eee; padding: 0px; height: 55px;"
              >設定值
              <nz-filter-trigger 
              [nzActive]="searchYieldValueValue.length > 0" 
              [nzDropdownMenu]="yieldValueMenu">
              <span nz-icon nzType="search"></span>
              </nz-filter-trigger>
              </th>
              <th nzWidth="5%" style="text-align:center; background-color: #eee; padding: 0px; height: 55px;">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let data of RowTable14.data;let i = index" class="editable-row">
              <ng-container *ngIf="!editCache14[data.id].edit; else editTemplate14">
                <td style="text-align:center; padding: 5px; height: 40px;">{{ data.SCH_SHOP_CODE }}</td>
                <td style="text-align:center; padding: 5px; height: 40px;">{{ data.EQUIP_GROUP }}</td>
                <td style="text-align:center; padding: 5px; height: 40px;">{{ data.YIELD_TYPE }}</td>
                <td style="text-align:center; padding: 5px; height: 40px;">{{ data.YIELD_VALUE | number }}</td>
                <td style="text-align:center; padding: 0px; height: 40px;">
                  <a (click)="editRow(data.id, 14)">修改</a>
                </td>
              </ng-container>
              <ng-template #editTemplate14>
                <td style="text-align:center; padding: 5px; height: 40px;">{{ data.SCH_SHOP_CODE }}</td>
                <td style="text-align:center; padding: 5px; height: 40px;">{{ data.EQUIP_GROUP }}</td>
                <td>
                  <nz-select placeholder="設定類型" [(ngModel)]="editCache14[data.id].data.YIELD_TYPE" (ngModelChange)="changeYieldType(data.id, $event)">
                    <nz-option nzValue="尺寸" nzLabel="尺寸"></nz-option>
                    <nz-option nzValue="長度" nzLabel="長度"></nz-option>
                    <nz-option nzValue="定值" nzLabel="定值"></nz-option>
                    <nz-option nzValue="-" nzLabel="　-　"></nz-option>
                  </nz-select>
                </td>
                <td>
                  <nz-input-number [disabled]="showYieldValue" placeholder="輸入產出型態" [(ngModel)]="editCache14[data.id].data.YIELD_VALUE" [nzMin]="0" [nzMax]="100" [nzStep]="1"></nz-input-number>
                </td>
                <td>
                  <a (click)="saveEdit(data.id, 14)">確認</a>&nbsp;&nbsp;&nbsp;
                  <a nz-popconfirm nzPopconfirmTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit(data.id, 14)">取消</a>
                </td>
              </ng-template>
            </tr>
            </tbody>
          </nz-table>
        </div>
      </div>

    </nz-tab>



  </nz-tabset>
</nz-content>

<!-- 鋼種新增 -->
<nz-modal
  [(nzVisible)]="isVisibleGrade"
  [nzWidth]="800"
  [nzContent]="gradeInputContent"
  [nzFooter]="gradeInputFooter"
  (nzOnCancel)="cancelGradeInput()">

  <ng-template #gradeInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;設定鋼種</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入鋼種" [(ngModel)]="GRADE_NO" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;特殊機台使用</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="特殊機台使用" [(ngModel)]="SPECIAL_EQUIP_CODE" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;鋼種類別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="鋼種類別" [(ngModel)]="GRADE_GROUP" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #gradeInputFooter>
    <button nz-button nzType="default" (click)="cancelGradeInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab1()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #gradeNoMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchByGradeNoValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGradeNo()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGradeNo()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #specialEquipCodeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchBySpecialEquipCodeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySpecialEquipCode()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySpecialEquipCode()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #gradeGroupMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchByGradeGroupValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGradeGroup()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGradeGroup()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- 站別機台關聯表新增 -->
<nz-modal
  [(nzVisible)]="isVisibleShop"
  [nzWidth]="800"
  [nzContent]="shopInputContent"
  [nzFooter]="shopInputFooter"
  (nzOnCancel)="cancelShopInput()">

  <ng-template #shopInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;工廠別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="工廠別" [(ngModel)]="PLANT" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站別代碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="站別代碼" [(ngModel)]="SHOP_CODE" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站別名</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="站別名" [(ngModel)]="SHOP_NAME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="機台" [(ngModel)]="EQUIP_CODE_1" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;設備名</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="設備名" [(ngModel)]="EQUIP_NAME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台群組</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="機台群組" [(ngModel)]="EQUIP_GROUP" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;有效碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="有效碼" [(ngModel)]="VALID" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #shopInputFooter>
    <button nz-button nzType="default" (click)="cancelShopInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab7()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #plantMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchPlantValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByPlant()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByPlant()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #shopCodeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopCodeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopCode()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopCode()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #shopNameMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopNameValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopName()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopName()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipCode1Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode1Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode1()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode1()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipNameMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipNameValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipName()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipName()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipGroupMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipGroupValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipGroup()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipGroup()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #validMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchValidValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByValid()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByValid()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- 設備能力新增 -->
<nz-modal
  [(nzVisible)]="isVisibleCapability"
  [nzWidth]="1000"
  [nzContent]="CapabilityInputContent"
  [nzFooter]="CapabilityInputFooter"
  (nzOnCancel)="cancelCapabilityInput()">

  <ng-template #CapabilityInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站號</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入站號" [(ngModel)]="SHOP_CODE_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">機台群組</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入機台群組" [(ngModel)]="EQUIP_GROUP_2" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;製程碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入製程碼" [(ngModel)]="PROCESS_CODE_2" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">鋼種類別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入鋼種類別" [(ngModel)]="GRADE_GROUP_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;形狀</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入形狀" [(ngModel)]="SHAPE_TYPE_2" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">投入尺寸上限</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入投入尺寸上限" [(ngModel)]="INPUT_DIA_MAX_2" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">設備能力最小尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入設備能力最小尺寸" [(ngModel)]="CAPABILITY_DIA_MIN_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">設備能力最大尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入設備能力最大尺寸" [(ngModel)]="CAPABILITY_DIA_MAX_2" />
          </td>
        </tr>

        
        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">設備能力最小長度</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入設備能力最小長度" [(ngModel)]="CAPABILITY_LENGTH_MIN_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">設備能力最大長度</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入設備能力最大長度" [(ngModel)]="CAPABILITY_LENGTH_MAX_2" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">最佳能力最小尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入最佳能力最小尺寸" [(ngModel)]="OPTIMAL_DIA_MIN_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">最佳能力最大尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入最佳能力最大尺寸" [(ngModel)]="OPTIMAL_DIA_MAX_2" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">最佳能力最小長度</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入最佳能力最小長度" [(ngModel)]="OPTIMAL_LENGTH_MIN_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">最佳能力最大長度</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入最佳能力最大長度" [(ngModel)]="OPTIMAL_LENGTH_MAX_2" />
          </td>
        </tr>

        
        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">替代機台順位1</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入替代機台順位1" [(ngModel)]="OPTION_EQUIP_1_2" />
          </td>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">替代機台順位2</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入替代機台順位2" [(ngModel)]="OPTION_EQUIP_2_2" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">替代機台順位3</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 60%; color: darkblue;" nz-input placeholder="輸入替代機台順位3" [(ngModel)]="OPTION_EQUIP_3_2" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #CapabilityInputFooter>
    <button nz-button nzType="default" (click)="cancelCapabilityInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab2()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #shopCode2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopCode2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopCode2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopCode2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipGroup2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipGroup2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipGroup2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipGroup2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipCode2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #processCode2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchProcessCode2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByProcessCode2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByProcessCode2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #gradeGroup2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchGradeGroup2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGradeGroup2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGradeGroup2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #shapeType2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShapeType2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShapeType2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShapeType2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #InputDiaMax2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchInputDiaMax2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByInputDiaMax2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByInputDiaMax2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #capabilityDiaMin2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchCapabilityDiaMin2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByCapabilityDiaMin2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByCapabilityDiaMin2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #capabilityDiaMax2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchCapabilityDiaMax2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByCapabilityDiaMax2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByCapabilityDiaMax2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #capabilityLengthMin2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchCapabilityLengthMin2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByCapabilityLengthMin2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByCapabilityLengthMin2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #capabilityLengthMax2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchCapabilityLengthMax2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByCapabilityLengthMax2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByCapabilityLengthMax2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #optimalDiaMin2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOptimalDiaMin2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOptimalDiaMin2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOptimalDiaMin2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #optimalDiaMax2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOptimalDiaMax2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOptimalDiaMax2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOptimalDiaMax2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #optimalLengthMin2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOptimalLengthMin2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOptimalLengthMin2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOptimalLengthMin2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #optimalLengthMax2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOptimalLengthMax2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOptimalLengthMax2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOptimalLengthMax2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #optionEquip1_2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchoptionEquip1_2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByoptionEquip1_2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByoptionEquip1_2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #optionEquip2_2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchoptionEquip2_2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByoptionEquip2_2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByoptionEquip2_2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #optionEquip3_2Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchoptionEquip3_2Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByoptionEquip3_2()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByoptionEquip3_2()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- 整備時間新增 -->
<nz-modal
  [(nzVisible)]="isVisiblePrepare"
  [nzWidth]="800"
  [nzContent]="prepareInputContent"
  [nzFooter]="prepareInputFooter"
  (nzOnCancel)="cancelPrepareInput()">

  <ng-template #prepareInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;上下料</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="上下料時間" [(ngModel)]="LOAD_TIME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;搬運</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="搬運時間" [(ngModel)]="TRANSFER_TIME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;整備時間</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="其他整備時間" [(ngModel)]="OTHER_TIME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;大調機</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="大調機時間" [(ngModel)]="BIG_ADJUST_TIME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;小調機</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="小調機時間" [(ngModel)]="SMALL_ADJUST_TIME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;退料</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="退料時間" [(ngModel)]="RETURN_TIME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;冷卻</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="冷卻時間" [(ngModel)]="COOLING_TIME" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #prepareInputFooter>
    <button nz-button nzType="default" (click)="cancelPrepareInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab3()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #equipCodeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCodeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchEquipCode()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #loadTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchLoadTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchLoadTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByLoadTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #transferTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchTransferTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByTransferTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByTransferTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #otherTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOtherTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOtherTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOtherTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #bigAdjustTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchBigAdjustTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByBigAdjustTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByBigAdjustTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #smallAdjustTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSmallAdjustTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySmallAdjustTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySmallAdjustTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #returnTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchReturnTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByReturnTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByReturnTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #coolingTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchCoolingTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByCoolingTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByCoolingTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<!-- 大調機新增 -->
<nz-modal
  [(nzVisible)]="isVisibleBigAdjust"
  [nzWidth]="800"
  [nzContent]="bigAdjustInputContent"
  [nzFooter]="bigAdjustInputFooter"
  (nzOnCancel)="cancelBigAdjustInput()">

  <ng-template #bigAdjustInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_4" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出尺寸最小值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入尺寸最小值" [(ngModel)]="DIA_MIN_4" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出尺寸最大值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入尺寸最大值" [(ngModel)]="DIA_MAX_4" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出型態</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產出型態" [(ngModel)]="SHAPE_TYPE_4" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;大調機代碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入大調機代碼" [(ngModel)]="BIG_ADJUST_CODE_4" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;小調機公差標準</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入小調機公差標準" [(ngModel)]="SMALL_ADJUST_TOLERANCE_4" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;爐批數量</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入爐批數量" [(ngModel)]="FURANCE_BATCH_QTY_4" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #bigAdjustInputFooter>
    <button nz-button nzType="default" (click)="cancelBigAdjustInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab4()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #equipCode4Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode4Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode4()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode4()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMin4Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMin4Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMin4()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMin4()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMax4Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMax4Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMax4()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMax4()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #shapeType4Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShapeType4Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShapeType4()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShapeType4()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #bigAdjustCode4Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchBigAdjustCode4Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByBigAdjustCode4()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByBigAdjustCode4()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #smallAdjustTolerance4Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSmallAdjustTolerance4Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySmallAdjustTolerance4()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySmallAdjustTolerance4()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #furanceBatchQty4Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchFuranceBatchQty4Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByFuranceBatchQty4()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByFuranceBatchQty4()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<!-- 小調機新增 -->
<nz-modal
  [(nzVisible)]="isVisibleSmallAdjust"
  [nzWidth]="800"
  [nzContent]="smallAdjustInputContent"
  [nzFooter]="smallAdjustInputFooter"
  (nzOnCancel)="cancelSmallAdjustInput()">

  <ng-template #smallAdjustInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_17" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出尺寸最小值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入尺寸最小值" [(ngModel)]="DIA_MIN_17" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出尺寸最大值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入尺寸最大值" [(ngModel)]="DIA_MAX_17" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出型態</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產出型態" [(ngModel)]="SHAPE_TYPE_17" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;小調機代碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入小調機代碼" [(ngModel)]="SMALL_ADJUST_CODE_17" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;小調機公差標準</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入小調機公差標準" [(ngModel)]="SMALL_ADJUST_TOLERANCE_17" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;爐批數量</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入爐批數量" [(ngModel)]="FURANCE_BATCH_QTY_17" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #smallAdjustInputFooter>
    <button nz-button nzType="default" (click)="cancelSmallAdjustInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab17()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #equipCode17Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode17Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode17()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode17()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMin17Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMin17Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMin17()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMin17()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMax17Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMax17Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMax17()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMax17()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #shapeType17Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShapeType17Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShapeType17()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShapeType17()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #smallAdjustCode17Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSmallAdjustCode17Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySmallAdjustCode17()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySmallAdjustCode17()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #smallAdjustTolerance17Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSmallAdjustTolerance17Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySmallAdjustTolerance17()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySmallAdjustTolerance17()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #furanceBatchQty17Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchFuranceBatchQty17Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByFuranceBatchQty17()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByFuranceBatchQty17()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- 線速新增 -->
<nz-modal
  [(nzVisible)]="isVisibleSpeed"
  [nzWidth]="800"
  [nzContent]="speedInputContent"
  [nzFooter]="speedInputFooter"
  (nzOnCancel)="cancelSpeedInput()">

  <ng-template #speedInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站號</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="站號" [(ngModel)]="SHOP_CODE_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出型態</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產出型態" [(ngModel)]="SHAPE_TYPE_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;鋼種類別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入鋼種類別" [(ngModel)]="GRADE_GROUP_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;線速分類</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入線速分類" [(ngModel)]="SPEED_TYPE_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;減面率MIN</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入減面率MIN" [(ngModel)]="REDUCTION_RATE_MIN_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;減面率MAX</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入減面率MAX" [(ngModel)]="REDUCTION_RATE_MAX_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出最小尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產出最小尺寸" [(ngModel)]="DIA_MAX_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出最大尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產出最大尺寸" [(ngModel)]="DIA_MIN_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;線速(m/min)</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入線速" [(ngModel)]="SPEED_5" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;日產出量</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入日產出量" [(ngModel)]="EQUIP_CAP_5" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #speedInputFooter>
    <button nz-button nzType="default" (click)="cancelSpeedInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab05()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #shopCode5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopCode5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopCode5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopCode5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipCode5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #shapeType5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShapeType5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShapeType5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShapeType5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #gradeGroup5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchGradeGroup5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGradeGroup5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGradeGroup5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #speedType5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSpeedType5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySpeedType5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySpeedType5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #reductionRateMin5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchReductionRateMin5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByReductionRateMin5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByReductionRateMin5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #reductionRateMax5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchReductionRateMax5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByReductionRateMax5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByReductionRateMax5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMax5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMax5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMax5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMax5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMin5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMin5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMin5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMin5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #speed5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSpeed5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySpeed5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySpeed5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipCap5Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCap5Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCap5()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCap5()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- 非線速新增 -->
<nz-modal
  [(nzVisible)]="isVisibleNonSpeed"
  [nzWidth]="800"
  [nzContent]="nonSpeedInputContent"
  [nzFooter]="nonSpeedInputFooter"
  (nzOnCancel)="cancelNonSpeedInput()">

  <ng-template #nonSpeedInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站號</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="站號" [(ngModel)]="SHOP_CODE_8" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_8" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出形狀</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產出形狀" [(ngModel)]="SHAPE_TYPE_8" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;尺寸最小值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出尺寸最小值" [(ngModel)]="DIA_MIN_8" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出尺寸最大值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出尺寸最大值" [(ngModel)]="DIA_MAX_8" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;加工時間</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="加工時間" [(ngModel)]="MINS_8" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #nonSpeedInputFooter>
    <button nz-button nzType="default" (click)="cancelNonSpeedInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab8()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #shopCode8Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopCode8Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopCode8()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopCode8()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipCode8Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode8Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode8()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode8()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #shapeType8Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShapeType8Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShapeType8()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShapeType8()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMin8Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMin8Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMin8()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMin8()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMax8Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMax8Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMax8()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMax8()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #mins8Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchMins8Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByMins8()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByMins8()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<!-- 退火爐工時新增 -->
<nz-modal
  [(nzVisible)]="isVisibleStove"
  [nzWidth]="800"
  [nzContent]="stoveInputContent"
  [nzFooter]="stoveInputFooter"
  (nzOnCancel)="cancelStoveInput()">

  <ng-template #stoveInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站號</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="站號" [(ngModel)]="SHOP_CODE_9" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_9" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;作業代碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入作業代碼" [(ngModel)]="OP_CODE_9" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;溫度</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="溫度" [(ngModel)]="TEMPERATURE_9" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;頻率</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="頻率" [(ngModel)]="FREQUENCY_9" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;每噸花時間</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="每噸花時間" [(ngModel)]="STEEL_GRADE_MIN_9" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #stoveInputFooter>
    <button nz-button nzType="default" (click)="cancelStoveInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab9()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #shopCode9Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopCode9Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopCode9()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopCode9()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipCode9Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode9Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode9()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode9()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #opCode9Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOpCode9Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOpCode9()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOpCode9()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #temperature9Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchTemperature9Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByTemperature9()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByTemperature9()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #frequency9Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchFrequency9Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByFrequency9()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByFrequency9()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #steelGradeMin9Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSteelGradeMin9Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySteelGradeMin9()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySteelGradeMin9()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<!-- 其他站別工時新增 -->
<nz-modal
  [(nzVisible)]="isVisibleOtherShop"
  [nzWidth]="800"
  [nzContent]="otherShopInputContent"
  [nzFooter]="otherShopInputFooter"
  (nzOnCancel)="cancelOtherShopInput()">

  <ng-template #otherShopInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站號</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入站號" [(ngModel)]="SHOP_CODE_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台碼" [(ngModel)]="EQUIP_CODE_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;鋼種</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入鋼種" [(ngModel)]="GRADE_NO_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;長度最小值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入長度最小值" [(ngModel)]="LENGTH_MIN_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;長度最大值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入長度最大值" [(ngModel)]="LENGTH_MAX_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;最小尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入最小尺寸" [(ngModel)]="DIA_MIN_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;最大尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入最大尺寸" [(ngModel)]="DIA_MAX_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;總時間</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入總時間" [(ngModel)]="TOTAL_TIMES_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;浸酸時間</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入浸酸時間" [(ngModel)]="PICKLING_TIMES_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;清洗時間</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入清洗時間" [(ngModel)]="WASHING_TIMES_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;瀝乾時間</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入瀝乾時間" [(ngModel)]="DRAINING_TIMES_10" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;投入上限值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入投入上限值" [(ngModel)]="BATCH_CNT_10" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #otherShopInputFooter>
    <button nz-button nzType="default" (click)="cancelOtherShopInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab10()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #shopCode10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopCode10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopCode10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopCode10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipCode10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #gradeNo10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchGradeNo10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGradeNo10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGradeNo10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #lengthMin10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchLengthMin10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByLengthMin10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByLengthMin10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #lengthMax10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchLengthMax10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByLengthMax10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByLengthMax10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMin10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMin10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMin10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMin10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMax10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMax10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMax10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMax10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #totalTimes10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchTotalTimes10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByTotalTimes10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByTotalTimes10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #picklingTimes10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchPicklingTimes10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByPicklingTimes10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByPicklingTimes10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #washingTimes10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchWashingTimes10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByWashingTimes10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByWashingTimes10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #drainingTimes10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDrainingTimes10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDrainingTimes10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDrainingTimes10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #batchCnt10Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchBatchCnt10Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByBatchCnt10()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByBatchCnt10()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- 研磨道次新增 -->
<nz-modal
  [(nzVisible)]="isVisibleGrinding"
  [nzWidth]="800"
  [nzContent]="grindingInputContent"
  [nzFooter]="grindingInputFooter"
  (nzOnCancel)="cancelGrindingInput()">

  <ng-template #grindingInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;鋼種類別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="鋼種類別" [(ngModel)]="GRADE_NO_13" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出型態</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出型態" [(ngModel)]="OUT_TYPE" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出成品尺寸最小值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出成品尺寸最小值" [(ngModel)]="DIA_MIN" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出成品尺寸最大值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出成品尺寸最大值" [(ngModel)]="DIA_MAX" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;研磨道次</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="研磨道次" [(ngModel)]="GRINDING_PASS" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;每刀研磨尺寸</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="每刀研磨尺寸" [(ngModel)]="GRINDING_SIZE" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #grindingInputFooter>
    <button nz-button nzType="default" (click)="cancelGrindingInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab13()">確定</button>
  </ng-template>

</nz-modal>


<nz-dropdown-menu #gradeNo13Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchGradeNo13Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGradeNo13()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGradeNo13()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #outTypeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOutTypeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOutType()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOutType()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMinMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMinValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMin()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMin()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #diaMaxMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDiaMaxValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDiaMax()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDiaMax()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #grindingPassMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchGrindingPassValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGrindingPass()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGrindingPass()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #grindingSizeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchGrindingSizeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByGrindingsize()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByGrindingsize()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- Campaign限制新增 -->
<nz-modal
  [(nzVisible)]="isVisibleCampaign"
  [nzWidth]="800"
  [nzContent]="campaignInputContent"
  [nzFooter]="campaignInputFooter"
  (nzOnCancel)="cancelCampaignInput()">

  <ng-template #campaignInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;站別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="站別" [(ngModel)]="SHOP_CODE_SCHE" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="機台" [(ngModel)]="CHOOSE_EQUIP_CODE" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出成品尺寸最小值</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出成品尺寸最小值" [(ngModel)]="DIA_MIN" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;Campaign ID</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="Campaign ID" [(ngModel)]="COMPAIGN_ID" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;欄位</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="欄位" [(ngModel)]="PARAMETER_COL" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;條件</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="條件" [(ngModel)]="PARAMETER_CONDITION" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;參數</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="參數" [(ngModel)]="PARAMETER_NAME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出尺寸MIN</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出尺寸MIN" [(ngModel)]="TURN_DIA_MAX_MIN" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出尺寸MAX</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="產出尺寸MAX" [(ngModel)]="TURN_DIA_MAX_MAX" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;抽數別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="抽數別" [(ngModel)]="SCHE_TYPE" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;交期區間MIN</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="交期區間MIN" [(ngModel)]="DATA_DELIVERY_RANGE_MIN" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;交期區間MAX</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="交期區間MAX" [(ngModel)]="DATA_DELIVERY_RANGE_MAX" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;生產日期 起</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="生產日期 起" [(ngModel)]="START_TIME" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;生產日期 訖</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="生產日期 訖" [(ngModel)]="END_TIME" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #campaignInputFooter>
    <button nz-button nzType="default" (click)="cancelCampaignInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab16()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #shopCodeScheMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchShopCodeScheValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByShopCodeSche()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByShopCodeSche()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #chooseEquipCodeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchChooseEquipCodeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByChooseEquipCode()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByChooseEquipCode()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #compaignIdMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchCompaignIdValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByCompaignId()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByCompaignId()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #compaignIdMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchCompaignIdValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByCompaignId()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByCompaignId()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #parameterColMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchParameterColValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByParameterCol()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByParameterCol()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #parameterConditionMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchParameterConditionValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByParameterCondition()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByParameterCondition()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #parameterNameMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchParameterNameValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByParameterName()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByParameterName()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #turnDiaMaxMinMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchTurnDiaMaxMinValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByTurnDiaMaxMin()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByTurnDiaMaxMin()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #turnDiaMaxMaxMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchTurnDiaMaxMaxValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByTurnDiaMaxMax()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByTurnDiaMaxMax()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #scheTypeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchScheTypeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByScheType()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByScheType()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #dataDeliveryRangeMinMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDataDeliveryRangeMinValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDataDeliveryRangeMin()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDataDeliveryRangeMin()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #dataDeliveryRangeMaxMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchDataDeliveryRangeMaxValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByDataDeliveryRangeMax()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByDataDeliveryRangeMax()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #startTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchStartTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByStartTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByStartTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #startTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchStartTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByStartTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByStartTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #endTimeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEndTimeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEndTime()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEndTime()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>


<!-- 清洗站設備能力表 -->
<nz-modal
  [(nzVisible)]="isVisibleWash"
  [nzWidth]="800"
  [nzContent]="washInputContent"
  [nzFooter]="washInputFooter"
  (nzOnCancel)="cancelWashInput()">

  <ng-template #washInputContent>
    <div>
      <table style="border-collapse: separate;">

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;機台</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入機台" [(ngModel)]="EQUIP_CODE_20" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;輸入產品種類</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產品種類" [(ngModel)]="KIND_TYPE_20" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;產出型態</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入產出型態" [(ngModel)]="OUTPUT_SHAPE_20" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;製程碼</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入製程碼" [(ngModel)]="PROCESS_CODE_20" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;FINAL_製程</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入FINAL_製程" [(ngModel)]="FINAL_PROCESS_20" />
          </td>
        </tr>

        <tr>
          <td style = "width: 110px; background-color: rgb(156, 182, 206); font-weight: bold; border-radius: 5px;">&nbsp;&nbsp;抽數別</td>
          <td style = "width: 600px; background-color: #eee;">&nbsp;
            <input style="width: 22%; color: darkblue;" nz-input placeholder="輸入抽數別" [(ngModel)]="SCHE_TYPE_20" />
          </td>
        </tr>

      </table>
    </div>
    
  </ng-template>

  <ng-template #washInputFooter>
    <button nz-button nzType="default" (click)="cancelWashInput()">取消新增</button>
    <button nz-button nzType="primary" (click)="insertTab20()">確定</button>
  </ng-template>

</nz-modal>

<nz-dropdown-menu #equipCode20Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipCode20Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipCode20()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipCode20()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #kindType20Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchKindType20Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByKindType20()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByKindType20()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #outputShape20Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchOutputShape20Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByOutputShape20()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByOutputShape20()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #processCode20Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchProcessCode20Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByProcessCode20()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByProcessCode20()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #finalProcess20Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchFinalProcess20Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByFinalProcess20()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByFinalProcess20()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #scheType20Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchScheType20Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByScheType20()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByScheType20()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>




<!-- 產率設定 -->

<nz-dropdown-menu #schShopCodeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchSchShopCodeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchBySchShopCode()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetBySchShopCode()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #equipGroup3Menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchEquipGroup3Value" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByEquipGroup3()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByEquipGroup3()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #yieldTypeMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchYieldTypeValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByYieldType()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByYieldType()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>

<nz-dropdown-menu #yieldValueMenu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input [(ngModel)]="searchYieldValueValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchByYieldValue()" class="search-button">查詢</button>
      <button nz-button nzSize="small" (click)="resetByYieldValue()">重設</button>
    </div>
  </div>
</nz-dropdown-menu>