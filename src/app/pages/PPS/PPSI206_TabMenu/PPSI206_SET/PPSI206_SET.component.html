<nz-content style="margin:0 16px;">
  
  <nz-spin nzTip="Loading..." [nzSize]="'large'" [nzSpinning]="loading">
    <div style="display: flex">
      <input
        type="file"
        id="fileupload"
        style="width: 190px;"
        (change)="incomingfile($event)"
        placeholder="Upload file"
        accept=".xlsx, .xls, .csv"
      />
      <button
        nz-button
        style="
          box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);
          background-color: #4caf50;
          border: 2px blue none;
          margin-right: 20px;
        "
        nzType="primary"
        (click)="Upload()"
      >
        <span nz-icon nzType="upload" nzTheme="outline"></span>
        E X C E L 匯入
      </button>
      <button
        nz-button
        style="
          box-shadow: 5px 5px 2px rgba(0, 0, 0, 0.24);
          background-color: #4caf50;
          border: 2px blue none;
        "
        nzType="primary"
        (click)="convertToExcel()"
      >
        <span nz-icon nzType="download" nzTheme="outline"></span>
        E X C E L 匯出
      </button>
      <button nz-button nzType="primary" 
        style="background-color: #4034eb; border: 3px solid; border-color: #4b48db; font-weight: bold; margin-left:300px; "
        (click)="convertData()"><span nzTheme="outline"></span>
        資料生成
      </button>
    </div>
    <p><p>

    <ag-grid-angular
      style="width: 100%; height: calc(100vh - 220px); overflow: scroll; "
      class="ag-theme-alpine"
      [rowData]="displayDataList"
      [columnDefs]="columnDefs"
      [pagination]="true"
      [suppressRowClickSelection]="true"
      [gridOptions]="gridOptions"
      [suppressClickEdit]="true"
      (cellDoubleClicked)="cellDoubleClickedHandler($event)"
      (cellEditingStopped)="cellEditingStoppedHandler($event)"
      [groupSelectsChildren]="true"
      [context]="myContext"
      [animateRows]="true"
      [editType]="editType"
      (gridReady)="onGridReady($event)"
    >
    </ag-grid-angular>
  </nz-spin>
</nz-content>
